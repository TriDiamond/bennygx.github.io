{"title":"IONIC 2 实现首页双击退出APP","uid":"b9c619014fc7379786141900ce0e39ef","slug":"ionic/listen-to-back-button","date":"2017-04-24T00:00:00.000Z","updated":"2021-03-29T15:45:27.483Z","comments":true,"path":"api/articles/ionic/listen-to-back-button.json","excerpt":"","keywords":null,"cover":"https://res.cloudinary.com/tridiamond/image/upload/v1571186961/blog/ionic_cover_hvzkwo.png","content":"<h2 id=\"添加绑定值\"><a href=\"#添加绑定值\" class=\"headerlink\" title=\"添加绑定值\"></a>添加绑定值</h2><blockquote>\n<p>首先在<code>app/app.html</code>下加入<code>#myNav</code>, 这个是用于绑定当前页面的导航标签</p>\n</blockquote>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-nav</span> <span class=\"token attr-name\">#myNav</span> <span class=\"token attr-name\">[root]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rootPage<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-nav</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"代码实现\"><a href=\"#代码实现\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h2><blockquote>\n<p>然后在<code>app.component.ts</code>做相对的改动</p>\n</blockquote>\n<pre class=\"line-numbers language-ts\" data-language=\"ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> Component<span class=\"token punctuation\">,</span> ViewChild <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> Platform<span class=\"token punctuation\">,</span> ToastController<span class=\"token punctuation\">,</span> Nav<span class=\"token punctuation\">,</span> App <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'ionic-angular'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> StatusBar <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@ionic-native/status-bar'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> SplashScreen <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@ionic-native/splash-screen'</span><span class=\"token punctuation\">;</span>\n\n\n@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  templateUrl<span class=\"token operator\">:</span> <span class=\"token string\">'app.html'</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>SplashScreen<span class=\"token punctuation\">,</span> StatusBar<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyApp</span> <span class=\"token punctuation\">&#123;</span>\n  rootPage <span class=\"token operator\">=</span> <span class=\"token string\">'TabsPage'</span><span class=\"token punctuation\">;</span>\n  backButtonPressed<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//用于判断返回键是否触发</span>\n  @<span class=\"token function\">ViewChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">'myNav'</span><span class=\"token punctuation\">)</span> nav<span class=\"token operator\">:</span> Nav<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">public</span> platform<span class=\"token operator\">:</span> Platform<span class=\"token punctuation\">,</span> <span class=\"token keyword\">private</span> splashScreen<span class=\"token operator\">:</span> SplashScreen<span class=\"token punctuation\">,</span> <span class=\"token keyword\">private</span> statusBar<span class=\"token operator\">:</span> StatusBar<span class=\"token punctuation\">,</span> <span class=\"token keyword\">public</span> app<span class=\"token operator\">:</span> App<span class=\"token punctuation\">,</span> <span class=\"token keyword\">public</span> toastCtrl<span class=\"token operator\">:</span> ToastController<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    platform<span class=\"token punctuation\">.</span><span class=\"token function\">ready</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token comment\">// Okay, so the platform is ready and our plugins are available.</span>\n      <span class=\"token comment\">// Here you can do any higher level native things you might need.</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>statusBar<span class=\"token punctuation\">.</span><span class=\"token function\">styleDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>statusBar<span class=\"token punctuation\">.</span><span class=\"token function\">backgroundColorByHexString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#661F22'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>splashScreen<span class=\"token punctuation\">.</span><span class=\"token function\">hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">registerBackButtonAction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//运行这个方法绑定返回按钮</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span>\n\n  <span class=\"token function\">registerBackButtonAction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>platform<span class=\"token punctuation\">.</span><span class=\"token function\">registerBackButtonAction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token comment\">//如果想点击返回按钮隐藏toast或loading或Overlay就把下面加上</span>\n      <span class=\"token comment\">// this.ionicApp._toastPortal.getActive() || this.ionicApp._loadingPortal.getActive() || this.ionicApp._overlayPortal.getActive();</span>\n      <span class=\"token keyword\">let</span> nav <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>app<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveNav</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nav<span class=\"token punctuation\">.</span><span class=\"token function\">canGoBack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">//是否已经到了首页</span>\n        nav<span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">showExit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span>\n\n  <span class=\"token comment\">//双击退出提示框</span>\n  <span class=\"token function\">showExit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>backButtonPressed<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">//当触发标志为true时，即2秒内双击返回按键则退出APP</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>platform<span class=\"token punctuation\">.</span><span class=\"token function\">exitApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n     <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toastCtrl<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n      message<span class=\"token operator\">:</span> <span class=\"token string\">'再按一次退出应用'</span><span class=\"token punctuation\">,</span>\n      duration<span class=\"token operator\">:</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">,</span>\n      position<span class=\"token operator\">:</span> <span class=\"token string\">'middle'</span>\n     <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">present</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>backButtonPressed <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n     <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>backButtonPressed <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//2秒内没有再次点击返回则将触发标志标记为false</span>\n    <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n","feature":null,"text":"添加绑定值 首先在app/app.html下加入#myNav, 这个是用于绑定当前页面的导航标签 &lt;ion-nav #myNav [root]=\"rootPage\">&lt;/ion-nav> 代码实现 然后在app.component.ts做相对的改动 import &#...","link":"","raw":"---\ntitle: \"IONIC 2 实现首页双击退出APP\"\nabstract: 在ICONIC 2 快速实现双击退出APP的功能\ndate: 2017/04/24\ncategories:\n  - Ionic\ntags:\n  - Ionic 2\n  - Angular 4\n  - Hybird App\ncover: https://res.cloudinary.com/tridiamond/image/upload/v1571186961/blog/ionic_cover_hvzkwo.png\n---\n\n## 添加绑定值\n> 首先在```app/app.html```下加入```#myNav```, 这个是用于绑定当前页面的导航标签\n\n```html\n <ion-nav #myNav [root]=\"rootPage\"></ion-nav>\n```\n\n## 代码实现\n> 然后在```app.component.ts```做相对的改动\n\n```ts\nimport { Component, ViewChild } from '@angular/core';\nimport { Platform, ToastController, Nav, App } from 'ionic-angular';\nimport { StatusBar } from '@ionic-native/status-bar';\nimport { SplashScreen } from '@ionic-native/splash-screen';\n\n\n@Component({\n  templateUrl: 'app.html',\n  providers: [SplashScreen, StatusBar]\n})\nexport class MyApp {\n  rootPage = 'TabsPage';\n  backButtonPressed: boolean = false;  //用于判断返回键是否触发\n  @ViewChild('myNav') nav: Nav;\n\n  constructor(public platform: Platform, private splashScreen: SplashScreen, private statusBar: StatusBar, public app: App, public toastCtrl: ToastController) {\n    platform.ready().then(() => {\n      // Okay, so the platform is ready and our plugins are available.\n      // Here you can do any higher level native things you might need.\n      this.statusBar.styleDefault();\n      this.statusBar.backgroundColorByHexString('#661F22');\n      this.splashScreen.hide();\n      this.registerBackButtonAction(); //运行这个方法绑定返回按钮\n    });\n  }\n\n  registerBackButtonAction() {\n    this.platform.registerBackButtonAction(() => {\n      //如果想点击返回按钮隐藏toast或loading或Overlay就把下面加上\n      // this.ionicApp._toastPortal.getActive() || this.ionicApp._loadingPortal.getActive() || this.ionicApp._overlayPortal.getActive();\n      let nav = this.app.getActiveNav();\n      if (nav.canGoBack()){ //是否已经到了首页\n        nav.pop();\n      }else{\n        this.showExit()\n      }\n    }, 1);\n  }\n\n  //双击退出提示框\n  showExit() {\n    if (this.backButtonPressed) { //当触发标志为true时，即2秒内双击返回按键则退出APP\n      this.platform.exitApp();\n    } else {\n     this.toastCtrl.create({\n      message: '再按一次退出应用',\n      duration: 2000,\n      position: 'middle'\n     }).present();\n     this.backButtonPressed = true;\n     setTimeout(() => this.backButtonPressed = false, 2000);//2秒内没有再次点击返回则将触发标志标记为false\n    }\n  }\n}\n```\n\n\n","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[{"name":"Ionic","slug":"Ionic","count":6,"path":"api/categories/Ionic.json"}],"tags":[{"name":"Ionic 2","slug":"Ionic-2","count":3,"path":"api/tags/Ionic-2.json"},{"name":"Hybird App","slug":"Hybird-App","count":6,"path":"api/tags/Hybird-App.json"},{"name":"Angular 4","slug":"Angular-4","count":4,"path":"api/tags/Angular-4.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%B7%BB%E5%8A%A0%E7%BB%91%E5%AE%9A%E5%80%BC\"><span class=\"toc-text\">添加绑定值</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0\"><span class=\"toc-text\">代码实现</span></a></li></ol>","author":{"name":"三钻","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":""},"mapped":true,"prev_post":{"title":"Lumen passport实现多个用户体系下的oauth验证","uid":"44e4c38c8d84ec4aadd2af71d96fa2b0","slug":"laravel/lumen-multi-oauth","date":"2019-01-10T01:40:41.000Z","updated":"2021-03-29T15:45:27.483Z","comments":true,"path":"api/articles/laravel/lumen-multi-oauth.json","keywords":null,"cover":"https://res.cloudinary.com/tridiamond/image/upload/v1571213684/blog/lumn_cover_uujop9.png","text":"这个教程是基于, lumen里面已经安装好了lumen-passport的插件, 如果还没有的话可以先到lumen使用laravel passport教程先安装. 改写Laravel Passport里面的UserRepository 文件路径 vendor\\laravel\\pa...","link":"","photos":[],"count_time":{"symbolsCount":"3.6k","symbolsTime":"3 mins."},"categories":[{"name":"Laravel","slug":"Laravel","count":3,"path":"api/categories/Laravel.json"}],"tags":[{"name":"Laravel Passport","slug":"Laravel-Passport","count":3,"path":"api/tags/Laravel-Passport.json"},{"name":"Lumen","slug":"Lumen","count":2,"path":"api/tags/Lumen.json"}],"author":{"name":"三钻","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":""}},"next_post":{"title":"IONIC 3 使用sliders轮播时拖动后autoplay失效解决方法","uid":"7f44014a2f442fb3c9579c3e2714cbfd","slug":"ionic/sliders-autoplay","date":"2017-04-20T00:00:00.000Z","updated":"2021-03-29T15:45:27.483Z","comments":true,"path":"api/articles/ionic/sliders-autoplay.json","keywords":null,"cover":"https://res.cloudinary.com/tridiamond/image/upload/v1571186961/blog/ionic_cover_hvzkwo.png","text":"我们先了解一下Ionic的Sliders 首先Ionic里面的sliders是用Swiper.js的第三方插件实现的, Ionic官方Sliders的文档里面只描述了可以直接写入html标签内的属性, 有很多高级属性是没有写在文档里面的. 要怎么改变sliders的其他属性呢? ...","link":"","photos":[],"count_time":{"symbolsCount":779,"symbolsTime":"1 mins."},"categories":[{"name":"Ionic","slug":"Ionic","count":6,"path":"api/categories/Ionic.json"}],"tags":[{"name":"Hybird App","slug":"Hybird-App","count":6,"path":"api/tags/Hybird-App.json"},{"name":"Ionic 3","slug":"Ionic-3","count":3,"path":"api/tags/Ionic-3.json"},{"name":"Angular 4","slug":"Angular-4","count":4,"path":"api/tags/Angular-4.json"}],"author":{"name":"三钻","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":""}}}